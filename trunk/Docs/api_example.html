<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>Image Uploader - Дополнительная информация по использованию</title>
<link href="default.css" rel="stylesheet" type="text/css" />
<!--<link href="styles/default.css" rel="stylesheet" type="text/css" />-->
<link href="prettify/prettify.css" rel="stylesheet" type="text/css" />
</head>
<body onload="prettyPrint()">
<script type="text/javascript" src="prettify/prettify.js"></script>
<div id="header">
<h1>Image Uploader scripting API</h1> <div id="version"></div>
</div>
 <div id="menu">
    <ul>
	<li><a href="api_example.html">Example script</a></li>
	<li><a href="api_implement.html">Functions to implement</a></li>			
        <li><a href="api_globals.html">Global functions</a></li>        
        <li><a href="api_classes.html">Classes</a></li>
    </ul>
</div>
<div id="content">
    <div id="left">
<h2>Создание плагинов</h2> 
<p>Для расширенной поддержки серверов в программе используются скрипты на <a href="http://www.squirrel-lang.org/" target="_blank">
 языке Squirrel 2</a>.</p>
<p>
<a href="http://www.squirrel-lang.org/doc/squirrel2.html" target="_blank">Документация языка Squirrel</a><br>
<a href="http://www.squirrel-lang.org/doc/sqstdlib2.html" target="_blank">Документация стандартной библиотеки языка Squirrel</a>
</p>
<p>Они должны быть сохранены в кодировке utf-8 в файлах с расширением <code>.nut</code>.
<p><b>Пример плагина (example.nut):</b> </p>
<pre class="prettyprint">
// Функция, загружающая файл
function  UploadFile(FileName, options)
{
    nm.setUrl("http://example.com/upload.php");
    nm.addQueryParamFile("file", FileName, ExtractFileName(FileName),"");
    nm.addQueryParam("submit", "Upload file!");
    nm.doUploadMultipartData();

    local response = nm.responseBody();
    local directUrl = regex_simple(response, "\\[IMG\\](.+)\\[/IMG\\]",0);
    
    options.setDirectUrl(directUrl);

    return 1; //успех
}

// Вспомогательная функция, упрощающая работу с регулярными выражениями
function regex_simple(data,regStr,start)
{
    local ex = regexp(regStr);
    local res = ex.capture(data, start);
    local resultStr = "";
    if(res != null){    
        resultStr = data.slice(res[1].begin, res[1].end);
    }
    return resultStr;
}

// Необязательные функции:
// Получение списка альбомов(папок, галерей) на сервере
function GetFolderList(list)
{
    // Ваш код
    return 1; //успех
}
 
// Функция, создающая альбомы
function CreateFolder(parentAlbum,album)
{
    // Ваш код
    return 1; //успех
}
 
function ModifyFolder(album)
{
    // Ваш код
    return 1; //успех
}
 
// Функция, возвращающая список видов ограничений доступа к альбому:
// приватный, общедоступный, только для друзей и т.п.
function GetFolderAccessTypeList()
{
    local a=["ТипДоступа1", "ТипДоступа2"];
    return a;
}



</pre>
<div class="script-functions">
<p>
В общем случае необходимо реализовать 1 функцию — <code>UploadFile</code>.<br>
Если нужна поддержка серверных альбомов, то необходимо реализовать еще 4 функции — <code>GetFolderList</code>, <code>CreateFolder</code>, 
<code>ModifyFolder</code>, <code>GetFolderAccessTypeList</code></i>.</p>
</div>
</div>
</div>
<div id="footer">
<p> Последнее обновление данного документа — 05.03.2015 года. Copyright &copy; 2007 - 2015, <a href="http://zenden.ws/imageuploader" class="link1">ZendeN</a></p>
</div>

</body>
</html>